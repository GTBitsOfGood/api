FROM node:18-alpine as deps

WORKDIR /app

RUN apk add --update python3 make g++ && rm -rf /var/cache/apk/*

COPY package.json ./

RUN yarn install 

FROM node:18 as dev

WORKDIR /app

COPY --from=deps /app/node_modules ./node_modules/

ENV PATH=/app/node_modules/.bin:$PATH

WORKDIR /app/src

COPY . .

EXPOSE 3000 
